import{r as c}from"./index-B2-qRKKC.js";import{c as V}from"./index-DQ4YbFVl.js";import{u as z}from"./index-BFjtS4uE.js";import{c as q}from"./index-Az_bokXk.js";import{u as J}from"./index-CpxwHbl5.js";import{P as G}from"./index-Bnp5pWmS.js";import{u as Q}from"./index-ciuW_uyV.js";import{u as W}from"./index-BlCrtW8-.js";import{u as X}from"./index-D6fdIYSQ.js";import{j as m}from"./jsx-runtime-DF2Pcvd1.js";function I(e,o,{checkForDefaultPrevented:n=!0}={}){return function(l){if(e==null||e(l),n===!1||!l.defaultPrevented)return o==null?void 0:o(l)}}var _="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},v="RovingFocusGroup",[y,N,$]=V(v),[H,Fe]=q(v,[$]),[ee,oe]=H(v),O=c.forwardRef((e,o)=>m.jsx(y.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(y.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(te,{...e,ref:o})})}));O.displayName=v;var te=c.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:n,orientation:t,loop:l=!1,dir:C,currentTabStopId:b,defaultCurrentTabStopId:S,onCurrentTabStopIdChange:E,onEntryFocus:p,preventScrollOnEntryFocus:u=!1,...F}=e,R=c.useRef(null),g=z(o,R),T=X(C),[w,r]=W({prop:b,defaultProp:S??null,onChange:E,caller:v}),[i,h]=c.useState(!1),a=Q(p),f=N(n),x=c.useRef(!1),[k,P]=c.useState(0);return c.useEffect(()=>{const s=R.current;if(s)return s.addEventListener(_,a),()=>s.removeEventListener(_,a)},[a]),m.jsx(ee,{scope:n,orientation:t,dir:T,loop:l,currentTabStopId:w,onItemFocus:c.useCallback(s=>r(s),[r]),onItemShiftTab:c.useCallback(()=>h(!0),[]),onFocusableItemAdd:c.useCallback(()=>P(s=>s+1),[]),onFocusableItemRemove:c.useCallback(()=>P(s=>s-1),[]),children:m.jsx(G.div,{tabIndex:i||k===0?-1:0,"data-orientation":t,...F,ref:g,style:{outline:"none",...e.style},onMouseDown:I(e.onMouseDown,()=>{x.current=!0}),onFocus:I(e.onFocus,s=>{const L=!x.current;if(s.target===s.currentTarget&&L&&!i){const D=new CustomEvent(_,Z);if(s.currentTarget.dispatchEvent(D),!D.defaultPrevented){const A=f().filter(d=>d.focusable),U=A.find(d=>d.active),B=A.find(d=>d.id===w),Y=[U,B,...A].filter(Boolean).map(d=>d.ref.current);M(Y,u)}}x.current=!1}),onBlur:I(e.onBlur,()=>h(!1))})})}),K="RovingFocusGroupItem",j=c.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:n,focusable:t=!0,active:l=!1,tabStopId:C,children:b,...S}=e,E=J(),p=C||E,u=oe(K,n),F=u.currentTabStopId===p,R=N(n),{onFocusableItemAdd:g,onFocusableItemRemove:T,currentTabStopId:w}=u;return c.useEffect(()=>{if(t)return g(),()=>T()},[t,g,T]),m.jsx(y.ItemSlot,{scope:n,id:p,focusable:t,active:l,children:m.jsx(G.span,{tabIndex:F?0:-1,"data-orientation":u.orientation,...S,ref:o,onMouseDown:I(e.onMouseDown,r=>{t?u.onItemFocus(p):r.preventDefault()}),onFocus:I(e.onFocus,()=>u.onItemFocus(p)),onKeyDown:I(e.onKeyDown,r=>{if(r.key==="Tab"&&r.shiftKey){u.onItemShiftTab();return}if(r.target!==r.currentTarget)return;const i=se(r,u.orientation,u.dir);if(i!==void 0){if(r.metaKey||r.ctrlKey||r.altKey||r.shiftKey)return;r.preventDefault();let a=R().filter(f=>f.focusable).map(f=>f.ref.current);if(i==="last")a.reverse();else if(i==="prev"||i==="next"){i==="prev"&&a.reverse();const f=a.indexOf(r.currentTarget);a=u.loop?ce(a,f+1):a.slice(f+1)}setTimeout(()=>M(a))}}),children:typeof b=="function"?b({isCurrentTabStop:F,hasTabStop:w!=null}):b})})});j.displayName=K;var re={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ne(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function se(e,o,n){const t=ne(e.key,n);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return re[t]}function M(e,o=!1){const n=document.activeElement;for(const t of e)if(t===n||(t.focus({preventScroll:o}),document.activeElement!==n))return}function ce(e,o){return e.map((n,t)=>e[(o+t)%e.length])}var Re=O,ge=j;export{ge as I,Re as R,Fe as c};
