import{r as i}from"./index-B2-qRKKC.js";import{P as m,d as _}from"./index-Bnp5pWmS.js";import{u as g}from"./index-BFjtS4uE.js";import{u as b}from"./index-ciuW_uyV.js";import{j as P}from"./jsx-runtime-DF2Pcvd1.js";import{I as U}from"./index-CFX93qP1.js";import{u as j}from"./index-D1vk04JX.js";function y(s,e,{checkForDefaultPrevented:n=!0}={}){return function(t){if(s==null||s(t),n===!1||!t.defaultPrevented)return e==null?void 0:e(t)}}function M(s,e=globalThis==null?void 0:globalThis.document){const n=b(s);i.useEffect(()=>{const r=t=>{t.key==="Escape"&&n(t)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var z="DismissableLayer",h="dismissableLayer.update",K="dismissableLayer.pointerDownOutside",X="dismissableLayer.focusOutside",w,x=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Y=i.forwardRef((s,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:t,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...E}=s,c=i.useContext(x),[d,S]=i.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=i.useState({}),N=g(e,a=>S(a)),L=Array.from(c.layers),[F]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),I=L.indexOf(F),D=d?L.indexOf(d):-1,W=c.layersWithOutsidePointerEventsDisabled.size>0,C=D>=I,k=J(a=>{const v=a.target,R=[...c.branches].some(p=>p.contains(v));!C||R||(t==null||t(a),l==null||l(a),a.defaultPrevented||u==null||u())},f),O=Q(a=>{const v=a.target;[...c.branches].some(p=>p.contains(v))||(o==null||o(a),l==null||l(a),a.defaultPrevented||u==null||u())},f);return M(a=>{D===c.layers.size-1&&(r==null||r(a),!a.defaultPrevented&&u&&(a.preventDefault(),u()))},f),i.useEffect(()=>{if(d)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(w=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),T(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=w)}},[d,f,n,c]),i.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),T())},[d,c]),i.useEffect(()=>{const a=()=>A({});return document.addEventListener(h,a),()=>document.removeEventListener(h,a)},[]),P.jsx(m.div,{...E,ref:N,style:{pointerEvents:W?C?"auto":"none":void 0,...s.style},onFocusCapture:y(s.onFocusCapture,O.onFocusCapture),onBlurCapture:y(s.onBlurCapture,O.onBlurCapture),onPointerDownCapture:y(s.onPointerDownCapture,k.onPointerDownCapture)})});Y.displayName=z;var q="DismissableLayerBranch",G=i.forwardRef((s,e)=>{const n=i.useContext(x),r=i.useRef(null),t=g(e,r);return i.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),P.jsx(m.div,{...s,ref:t})});G.displayName=q;function J(s,e=globalThis==null?void 0:globalThis.document){const n=b(s),r=i.useRef(!1),t=i.useRef(()=>{});return i.useEffect(()=>{const o=u=>{if(u.target&&!r.current){let E=function(){B(K,n,c,{discrete:!0})};const c={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",t.current),t.current=E,e.addEventListener("click",t.current,{once:!0})):E()}else e.removeEventListener("click",t.current);r.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",t.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function Q(s,e=globalThis==null?void 0:globalThis.document){const n=b(s),r=i.useRef(!1);return i.useEffect(()=>{const t=o=>{o.target&&!r.current&&B(X,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function T(){const s=new CustomEvent(h);document.dispatchEvent(s)}function B(s,e,n,{discrete:r}){const t=n.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:n});e&&t.addEventListener(s,e,{once:!0}),r?_(t,o):t.dispatchEvent(o)}var V="Portal",Z=i.forwardRef((s,e)=>{var u;const{container:n,...r}=s,[t,o]=i.useState(!1);j(()=>o(!0),[]);const l=n||t&&((u=globalThis==null?void 0:globalThis.document)==null?void 0:u.body);return l?U.createPortal(P.jsx(m.div,{...r,ref:e}),l):null});Z.displayName=V;export{Y as D,Z as P};
